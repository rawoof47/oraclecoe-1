<app-navbar></app-navbar>

<app-page-banner
  [pageTitle]="'Applied Jobs'"
  [backgroundImage]="'img/page-title-bg.jpg'"
></app-page-banner>

<div class="dashboard-area ptb-100">
  <div class="container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-lg-4 col-md-12">
        <!-- (Optional) Insert sidebar content here -->
      </div>

      <!-- Applied Jobs -->
      <div class="col-lg-8 col-md-12">
        <!-- Header with stats -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="dashboard-heading">Your Applications</h2>
          <span class="badge badge-pill badge-light">
            {{ appliedJobPosts.length }} Applied Jobs
          </span>
        </div>

        <!-- Error Message -->
        <div *ngIf="error" class="alert alert-danger alert-dismissible fade show">
          {{ error }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <!-- Jobs List -->
        <ng-container *ngIf="!loading && appliedJobPosts.length > 0; else noJobs">
          <div class="job-listings">
            <article
              *ngFor="let job of appliedJobPosts"
              class="employer-item card mb-4 border-0 shadow-hover"
            >
              <div class="card-body p-4">
                <a
                  [routerLink]="['/job-details', job.id]"
                  class="job-link d-block text-decoration-none"
                >
                  <!-- Title and Logo -->
                  <div class="d-flex align-items-start mb-3">
  <div class="employer-logo mr-3 flex-shrink-0">
    <img
  src="/src/assets/img/home-two/cat7.png"
  alt="{{ job.job_title }} logo"
  class="job-img rounded"
/>

  </div>
                    <div>
                      <h3 class="job-title mb-1">{{ job.job_title }}</h3>
                      <div class="company-name text-muted mb-2">
                        Company name not specified
                      </div>
                      <!-- Meta -->
                      <ul class="job-meta list-inline mb-3">
                        <li class="list-inline-item mr-3">
                          <i class="fas fa-map-marker-alt text-primary mr-1"></i>
                          {{ job.location || 'Location not specified' }}
                        </li>
                        <li class="list-inline-item">
                          <i class="far fa-clock text-primary mr-1"></i>
                          Posted {{ formatPostedDate(job.created_at) }}
                        </li>
                      </ul>
                    </div>
                  </div>

                  <!-- Description -->
                  <div class="job-description mb-3 text-muted">
                    {{
                      job.job_description
                        ? (job.job_description.length > 120
                          ? (job.job_description | slice:0:120) + '...'
                          : job.job_description)
                        : 'No description provided.'
                    }}
                  </div>

                  <!-- Status Indicator -->
                  <div class="application-status mb-3">
                    <span class="badge badge-success badge-pill">
                      <i class="fas fa-check-circle mr-1"></i> Application Submitted
                    </span>
                  </div>

                  <!-- Extra Info -->
                  <div class="job-extra-info mb-3">
                    <div class="row">
                      <div class="col-md-6 mb-2 mb-md-0">
                        <div class="detail-item">
                          <span class="detail-label">Experience</span>
                          <span class="detail-value">
                            {{ job.experience_min || '0' }} - {{ job.experience_max || 'N/A' }} years
                          </span>
                        </div>
                      </div>
                      <div class="col-md-6 mb-2 mb-md-0">
                        <div class="detail-item">
                          <span class="detail-label">Compensation</span>
                          <span class="detail-value">
                            {{ job.compensation_range || 'Not specified' }}
                          </span>
                        </div>
                      </div>
                      <div class="col-md-6 mb-2 mb-md-0">
                        <div class="detail-item">
                          <span class="detail-label">Work Mode</span>
                          <span class="detail-value">
                            {{ job.work_mode || 'Not specified' }}
                          </span>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="detail-item">
                          <span class="detail-label">Deadline</span>
                          <span class="detail-value">
                            {{
                              job.application_deadline
                                ? (job.application_deadline | date: 'mediumDate')
                                : 'N/A'
                            }}
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Tags -->
                  <div class="job-tags">
                    <span
                      *ngIf="job.modules_required"
                      class="badge badge-primary badge-pill mr-2 mb-1"
                    >
                      <i class="fas fa-cube mr-1"></i>
                      {{ job.modules_required }}
                    </span>
                    <span class="badge badge-secondary badge-pill mb-1">
                      <i class="fas fa-briefcase mr-1"></i>
                      {{ job.employment_type || 'N/A' }}
                    </span>
                  </div>
                </a>

                <!-- Applied Status Button -->
                <div class="d-flex justify-content-between align-items-center mt-3 pt-3 border-top">
                  <div class="application-date text-muted small">
                    Applied on {{ job.created_at | date: 'mediumDate' }}
                  </div>
                  <button class="btn btn-success btn-sm" disabled>
                    <i class="fas fa-check-circle mr-1"></i> Applied
                  </button>
                </div>
              </div>
            </article>
          </div>
        </ng-container>

        <!-- No Jobs Template -->
        <ng-template #noJobs>
          <div class="empty-state text-center py-5" *ngIf="!loading">
            <div class="empty-icon mb-3">
              <i class="fas fa-file-alt fa-3x text-muted"></i>
            </div>
            <h3 class="h5">No applications yet</h3>
            <p class="text-muted mb-4">Your applied jobs will appear here once you start applying</p>
            <a routerLink="/jobs" class="btn btn-primary">
              <i class="fas fa-search mr-2"></i>Browse Jobs
            </a>
          </div>
        </ng-template>

        <!-- Loading Indicator -->
        <div *ngIf="loading" class="loading-indicator text-center py-5">
          <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
            <span class="sr-only">Loading applied jobs...</span>
          </div>
          <p class="mt-3 text-muted">Loading your applications...</p>
        </div>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>
<app-back-to-top></app-back-to-top>
